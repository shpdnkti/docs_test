## 版本信息

|后台模块|版本|
|--|--|
|bkiam|1.4.8|
|bklog|4.2.367|
|bkmonitorv3|3.3.856|
|bknodeman|2.0.534|
|bkssm|1.0.8|
|cmdb|3.9.6|
|fta|5.2.7|
|gse|3.5.12|
|job|3.1.1.246|
|license|3.1.5|
|open_paas|2.11.51|
|paas_agent|2.6.0|
|usermgr|2.2.0|

|SaaS|版本|
|--|--|
|bk_iam|1.1.40|
|bk_nodeman|2.0.1110|
|bk_log_search|4.2.367|
|bk_sops|3.6.15|
|bk_monitorv3|3.3.1347|
|bk_itsm|2.5.5.162|
|bk_fta_solutions|5.2.9|
|bk_user_manage|2.1.1|

|gse plugin|版本|
|--|--|
|basereport|10.7.32|
|processbeat|1.11.34|
|exceptionbeat|1.1.14|
|bkmonitorbeat|1.10.43|
|bkmonitorproxy|1.1.26|
|bkunifylogbeat|7.1.29|
|pluginscripts|1.0.1|
|gsecmdline|2.0.3|

## 版本日志
### 版本整体
- consul 1.7.2
- consul-template 0.25.1
- docker 18.09.9
- elasticsearch 7.6.1
- influxdb 1.7.10
- kafka 0.10.2.0
- mysql 5.7.29
- redis 5.0.9
- zookeeper 3.4.14
- rabbitmq 3.8.3
- openresty 1.15.8.3 
- mongodb 4.2.3 

### 部署脚本

#### 安全更新

- 蓝鲸后台模块除gse外，均使用blueking，低权限账号启动，不再使用root账号
- 开源组件使用rpm包安装，且创建相应低权限账号运行，不再使用root账号
- Redis Sentinel模式下，增加密码认证
- zookeeper默认启动参数禁用jmx的远程访问
- influxdb 默认增加密码认证
- nginx的ssl_protocols配置调整只支持TLSv1.2 TLSv1.3协议

#### 蓝鲸产品部署调整

- [新增] 蓝鲸后台模块除gse外，均使用blueking账户启动，systemd托管。
- [变更] 蓝鲸配置渲染方式重构，模板占位符统一`BK_`前缀避免潜在和开源软件的变量冲突的可能
- [部署] pip包安装统一为离线本地pip源安装方式
- [优化] 部署前初始化蓝鲸安装主机，并对每个节点做基础检查
- [变更] 安装部署蓝鲸组件的脚本剥离为独立的install_*.sh脚本
- [新增] 新增release_*.sh 脚本用于单独更新蓝鲸组件包
- [新增] 新增health_check/check_*.sh脚本用于检查蓝鲸的服务状态
- [变更] 切换confd生成nginx配置为consul-template来动态生成nginx配置
- [变更] 使用openresty来代替nginx作为web接入层
- [变更] 进程守护使用systemd，不再添加crontab的进程检查脚本
- [优化] 使用pssh套件代替串行执行ssh命令执行远程命令
- [变更] Python工程均使用蓝鲸加密python解释器部署，保护源码
- [变更] Consul健康检查从脚本判断进程调整为TCP检测端口存活

### 权限中心（iam + bk_iam_app）

- 【新增】系统接入权限中心API
- 【新增】针对个人的授权/回收权限API
- 【新增】用户申请权限，包括加入用户组、自定义权限申请
- 【新增】我的权限展示，包括自定义权限、加入的用户组
- 【新增】我的申请，个人申请过的所有单据
- 【新增】我的审批，个人审批的所有待审批、已审批单据
- 【新增】权限模板，包括权限模板的增删改查，以及权限模板关联用户组
- 【新增】通过组织架构管理用户或者组织的权限
- 【新增】用户组，包括用户组的增删改查，以及添加人员、添加权限能力
- 【新增】依赖操作，用户申请勾选了某个操作，权限中心会自动将相关依赖操作一并申请
- 【新增】新建关联操作，用户新建某个资源，会自动授予该资源相关的所有操作权限
- 【新增】拓扑选择实例，支持通过拓扑来选择具体实例
- 【新增】属性选择实例，支持通过属性来动态选择实例
- 【新增】操作分组，支持系统注册操作时按照分类展示

### 用户管理（usermgr  + bk_user_manage )

- 【修复】修复用户删除后审计记录错乱问题
- 【新增】企业版 3.0 正式接入权限中心
- 【修复】获取非默认目录的部门下用户时 username 字段拼接错误问题 
- 【优化】项目依赖，提升企业版部署安装速度
- 【修复】部门新建后无法在列表中显示的问题
- 【修复】旧版数据迁移时密码过期导致人员详情无法展示的问题
- 【新增】支持自定义字段唯一性校验
- 【新增】增加自定义目录支持
- 【修复】完善产品后端数据国际化
- 【优化】多目录开启时全量数据返回效率
- 【修复】搜索用户信息时手机号无法展示问题

### PaaS 平台（open_paas）

- 【新增】对接权限中心 3.0
- 【新增】后台支持oauth2登录模式接入
- 【新增】开发者中心日志采集及查看支持Elasticsearch 7.0
- 【新增】SaaS 部署方式优化为在 docker 内运行
- 【优化】将权限体系的接入模式切换为iam-python-sdk，目前是1.0.4支持缓存
- 【修复】ESB 修复 sops 的文档展示内容
- 【修复】开发者中心部分前端展示缺陷
- 【更新】ESB 更新 cc、iam 等的 confapis
- 【更新】ESB 更新 cc delete_cloud_area use POST method
- 【更新】ESB 更新 bcs apigw-bcs-app.yaml

### 配置平台（cmdb）

-  【新增】全文检索功能
- 【 新增】服务模板支持对服务进行标准化管理
- 【新增】服务分类对服务进行归类梳理
- 【新增】业务集群模版功能
- 【新增】运营统计功能
- 【新增】业务自定义字段功能
- 【新增】主机属性自动应用功能
- 【新增】模型的用户字段类型
- 【新增】模型的部门组织字段类型
- 【新增】业务对象的事件监听功能
- 【新增】云主机资源同步功能
- 【新增】云账户管理功能
- 【新增】云区域管理功能
- 【优化】操作审计功能
- 【优化】首页支持固资编号查询主机
- 【优化】权限对接到蓝鲸权限中心3.0
- 【优化】系统结构为：业务、资源、模型、运营统计四大板块
- 【优化】业务拓扑功能，整合了业务主机和服务拓扑
- 【优化】主机转移功能，拆分为业务模块、空闲模块、资源池三个子功能
- 【优化】实例详情页交互

### 管控平台（gse）
- 【新增】procmgr增加支持通过zk服务发现taskserver节点
- 【新增】agent进程管理模块合入进程资源分组功能
- 【优化】procmgr和syncdata服务调整cmdb的主机查询新接口(list_hosts_without_biz)
- 【优化】gse server采用systemd部署，安装包的bin目录移除gsectl脚本
- 【优化】gsectl脚本按gse agent, gse proxy调整为2个gsectl脚本
- 【优化】gsectl.bat脚本优化启动问题
- 【优化】移除gse_opts, gse_ops配置模板文件
- 【优化】gse_task, gse_file增加thrift库异常捕获，加强异常保护
- 【优化】gse_agent proxy模式时，加强上行消息的可靠性
- 【修复】gse_file修复日志格式化变量类型错误
- 【修复】gse_procmgr修复同步多内网IP的主机进程状态查询问题
- 【修复】gse_syncdata修复同步多内网IP

### 作业平台（job）

- 【修复】执行方案排版问题
- 【修复】脚本详情编辑宽度计算样式问题
- 【修复】定时任务编辑显示问题
- 【优化】动态分组接口调整

### 监控平台（bkmonitor + bk_monitor）

- 【新增】 对接权限中心 3.0
- 【新增】 新仪表盘
- 【新增】 插件制作,采集任务,可通过scirpt Prometheus(exporter) Datadog(agent) JMX 等方式采集数据
- 【新增】 告警组,策略配置支持8种检测算法,不同维度的汇聚计算,告警收敛,无数据告警等
- 【新增】 批量导出导入
- 【新增】 自定义指标/事件上报(HTTP SDK 命令行)
- 【新增】 日志关键字事件
- 【新增】 支持ICMP拨测
- 【新增】 全局设置
- 【新增】 国际化
- 【新增】 数据检索
- 【新增】 告警事件移动端
- 【新增】 exceptionbeat ,bkmonitorproxy 采集器
- 【新增】 采集目标支持服务实例
- 【新增】 通知方式支持 企业微信群, HTTP回调,消息队列
- 【优化】 主机监控全新交互
- 【优化】 服务拨测全新交互
- 【优化】 事件中心全新交互和性能优化
- 【优化】 前后端分离
- 【优化】 告警事件生成和通知优化,通知模版
- 【优化】 basereport,processbeat,bkmonitorbeat采集指标和性能
- 【优化】 目标选择器支持集群和服务模版

### 故障自愈（fta + bk_fta_solutions）

- 【新增】 对接监控3.2
- 【新增】 处理套餐增加ITSM创建单据
- 【新增】 故障自愈替换配置文件的环境变量名称
- 【优化】 修改自愈帮助的状态请求接口为BK_PAAS_INNER_HOST
- 【优化】 作业平台仅支持全局变量传参数，需配合后台>=5.2.5, saas>=5.2.8
- 【优化】 替换调人员选择器
- 【优化】 快捷套餐的使用替换
- 【优化】 蓝鲸监控3改名为蓝鲸监控平台
- 【优化】 蓝鲸监控3.2的告警策略刷新业务运维可以操作
- 【优化】 超级管理员可以操作所有的业务内容
- 【优化】 API错误信息页面展示接口错误日志
- 【优化】 去掉search_host接口的使用
- 【优化】 超级管理员权限扩充,自愈的超级管理员自行修改
- 【优化】 修改所有快捷套餐的执行方式（转移故障机，作业执行等)

### 节点管理（bk_nodeman）

- 【优化】接入点保存去掉已存在使用IP限制 
- 【优化】BT节点探测默认显示并开启
- 【优化】替换CMDB search_host接口
- 【修复】首次部署密钥key获取错误问题
- 【修复】Proxy 安装配置格式问题处理
- 【修复】任务历史搜索多个业务为空的问题
- 【修复】全局配置保存报错问题修复
- 【修复】修复gsectl脚本自身标准输出导致重启Agent失败问题
- 【修复】首次部署migrate报错
- 【修复】兼容CMDB list_biz_hosts返回Non

### 标准运维（bk_sops）

- 【新增】统一接入权限中心 V3  
- 【新增】画布交互优化，快速复制，键盘快捷键等丰富功能
- 【新增】支持查看节点执行日志
- 【新增】流程支持打回功能
- 【洗澡能】流程判断支持更多python语法，如datetime, re, hashlib, random
- 【优化】变量类型从9个增加到16个

### 日志平台（bk_log_search）

- 【新增】新增日志检索V2版本的采集配置迁移命令
- 【优化】获取索引集Fields API支持缓存
- 【修复】增加对检索返回结果进行xss处理 防止xss攻击
- 【修复】修复页面刷新时，如果URL存在#符号则未能匹配到业务的问题

### 流程服务
- 【新增】前端组件升级
- 【新增】节点支持配置动态处理人
- 【新增】节点字段支持关联约束
- 【新增】任务模板配置管理
- 【新增】流程内支持任务组功能
- 【新增】节点配置去掉动作按钮
- 【新增】触发器配置管理
- 【新增】流程中支持触发器功能
- 【新增】支持流程管理员及负责人的配置管理
- 【新增】API支持编写沙箱代码
- 【新增】流程内的公共变量扩展
- 【新增】系统功能开关丰富
- 【新增】提供快速提单入口
- 【修复】修复富文本打包缺陷
- 【新增】SLA管理模块
- 【新增】基础模型和公共字段
- 【新增】服务目录排序
- 【新增】单选人员选择器组件
- 【新增】通知模板开放配置
- 【新增】母子单功能
- 【新增】权限中心V3接入
- 【新增】新增字段默认值添加富文本
- 【新增】api 节点失败处理（重试，忽略）
- 【新增】关注人按钮，关注人列表
- 【新增】新增批量审批
- 【新增】富文本内的链接支持新标签中打开
- 【新增】审批节点
- 【优化】升级开发框架
- 【优化】升级到Python3
- 【优化】全局视图表格优化，添加处理人，筛选条件，自定义表头等；i18n 提取
- 【优化】时间控件默认显示当前时间
- 【优化】后台管理菜单 icon 替换
- 【优化】处理人组件改为失焦时显示一行，聚焦时显示多行
- 【优化】如果会签节点或审批节点状态为处理中，则提交按钮显示 loading
- 【优化】调整标准运维任务重试和创建的逻辑
- 【优化】快速提单跳转到全局视图我的申请单
- 【优化】审批条件参数优化
- 【优化】工单列表和工单详情样式优化
- 【优化】magicbox 升级到 2.2.1
- 【优化】节点详情和日志详情样式优化
- 【优化】pass 平台申请权限会在新浏览器标签中打开
- 【优化】权限申请通过后，菜单栏刷新未更新权限

