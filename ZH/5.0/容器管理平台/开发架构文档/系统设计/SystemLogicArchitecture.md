# 系统逻辑架构

![-w2020](../media/cd3a2907ed89fb728305348f16c140fd.png)
<center>容器管理平台逻辑架构图</center>

容器管理平台主要包含三个子系统服务，分别是容器服务，监控中心和配置中心。

## 容器服务

容器服务作为蓝鲸智云 PaaS上 面的 SaaS App，
提供了基于 Kubernetes 和 Mesos 两种编排引擎的容器管理功能。
这些功能包括了集群管理，模板集/Helm，资源的查看与更新，WebConsole 等。容器服务各个系统模块的功能介绍：

**projects:** 与配置中心对接，负责处理容器服务项目功能，如更新项目信息，获取项目列表等。

**cluster:** 负责集群管理功能，如集群初始化，添加节点，删除节点等。

**configuration:** 主要完成模板集的版本管理与实例化功能，同时支持 Kubernetes 和 Mesos 两种编排引擎的各类资源。

**instance:** 各类资源的配置文件生成器，是 configuration 模块实例化的基础模块。

**depot:** 对接 Habor API，支持对镜像仓库的数据查询功能，如查询项目下的镜像列表等。

**application:** 主要负责与应用相关的资源实例的状态查询，滚动更新，删除等操作功能。这些资源包括 Deployment，Daemonset，Application 等。

**network:** 负责网络资源的管理功能，包括查询，更新，删除等操作。网络资源如 Service，Ingress，LoadBalance。

**resource:** 负责配置资源的管理功能，包括查询，更新，删除等操作。配置资源如 Configmap，Secret。

**web_console:** 利用 websocket 技术，实现了对 Kubernetes 集群的 kubectl 命令行交互功能，同时支持直接登录到容器中。

**bcs_k8s:** 容器服务中的 Helm 处理模块，支持用户通过 Helm charts 完成应用部署。

**components:** 容器服务中对接第三方系统的模块，例如对接 CMDB，权限中心等。

## 监控中心

监控中心提供对集群、节点和容器级别的监控与告警功能。监控中心各个系统模块的功能介绍：

**backend:** 监控中心的 SaaS APP，提供告警策略创建，变更，事件创建，告警屏蔽等功能。

**data_access:** 基础性能拉取，根据用户配置的维度，准确拉取待检测原始告警数据。

**data_detect:** 对基础性能告警，根据监控指标以及触发条件进行异常检测计算。

**poll_alarm:** 拉取事件，或者已经检测超过阀值的基础性能告警。

**match_alarm:** 告警匹配，按用户配置的动态规则，如集群，事件级别，事件 labels 等过滤用户需要告警。

**converage:** 告警收敛，用户可以按不同的收敛策略，配置收敛规则，减少突发告警，提高告警质量。

**collect:** 告警的汇总，告警通知，对同一个告警，按不同用户，不同通知渠道差异化通知功能。

## 配置中心

配置中心作为容器管理平台的底层系统，提供了如项目，集群快照，区域，节点信息，软件版本等各类元数据的存取功能。配置中心各个系统模块的功能介绍：

**基础功能模块：** 包括了storage、config、component。它们是配置中心的核心模块。

**api:** 提供给上层查询元数据的功能，这些数据包括集群快照，区域信息等。

**logging：** 配置中心的日志模块。
